#!/usr/bin/env sh

set -ex

cmd=$1
component=$2
environment=$3

cd "./components/${component}/"

terraform workspace select $environment &
wait $!

case $component in
  "networking")
     ;;
  "eks")
     ;;
  *)
    echo "Unknown aomponent: ${component}"
    exit 1
    ;;
esac

terraform ${cmd} -var="environment=${environment}" -var-file="vars/${environment}.tfvars"
